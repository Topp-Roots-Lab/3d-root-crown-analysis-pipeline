# 3-D Root Crown Analysis Pipeline

Stable version: 1.0.0

Author: Ni Jiang

Compatibility: Python 3

This set of scripts is used to analyze 3-D volumes of maize root crowns.

- [Input & Output](#input-&-output)
- [Usage](#usage)
- [Descriptions](#description)
- [Troubleshooting](#troubleshooting)
- [Additional Information](#additional-information)

## Input & Output

### Input

The input data consists of a `.raw` and its paired `.dat` file. Both of these
can be generated by the NorthStar Imaging (NSI) Software from exporting a
`.raw` volume.

### Output

The results of this pipeline are a `.tsv` of features and a `csv` of traits
calculated from the provided volume.

## Usage

An example run of the entire pipeline (omitting meshlabserver) is as follows:

```bash
python raw2img.py -i ./myVolume/
python batch_segmentation.py -s 2 -i ./myVolume/
python batch_skeleton.py -i ./myVolume_3d_models/
python rootCrownImageAnalysis3D.py -s 2 -t 0.104 -i ./myVolume_thresholded_images/
```

## Root Crown Analysis Pipeline Flowchart

This is an overview of the execution sequence for analyzing root crown x-ray
scans.

<p align="center">
  <img alt="Root Crown Analysis Pipeline Flowchart" src="docs/img/root-crown-pipeline-flowchart.png">
</p>

## Description

Below is a description of each individual module.

### Volume to Image Conversion (`raw2img.py`)

Converts the a `.raw` volume into an grayscale image stack.
The volume is sliced along the Z axis, from top to bottom.

### Segmentation (`batch_segmentation.py`)

Converts the grayscale image stack into binary image stack. You have the option
to remove soil if the `--soil` option is provided.

### GiA3D or Skeletonization/Mesh Generation (`batch_skeleton.py`)

Converts a point cloud representation of the root system into a 3-D mesh.
Currently, this module also produces the skeleton of the root system as well.

### Analysis (`rootCrownImageAnalysis3D.py`)

Analyzes the root system based on the binary image stack and calculates traits
for the root system.

## Troubleshooting

If you encounter an issues, please submit a GitHub issue: https://github.com/Topp-Roots-Lab/3d-root-crown-analysis-pipeline/issues

## Additional Notes

None at this time